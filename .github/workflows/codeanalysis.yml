name: Code Analysis

on:
    push:
        branches:
            - master

jobs:
    cppcheck:
        runs-on: ubuntu-latest

        steps:
        - name: Checkout repository
          uses: actions/checkout@v2

        - name: Install cppcheck
          run: sudo apt-get install -y cppcheck

        - name: Run cppcheck
          run: | 
            cppcheck --enable=all --inconclusive --xml --xml-version=2 . 2> cppcheck-report.xml
            cppcheck --enable=all --inconclusive.


        - name: Upload cppcheck report
          uses: actions/upload-artifact@v3
          with:
            name: cppcheck-report
            path: cppcheck-report.xml